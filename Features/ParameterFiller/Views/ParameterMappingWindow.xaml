<Window
    x:Class="COBIeManager.Features.ParameterFiller.Views.ParameterMappingWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:COBIeManager.Shared.Converters"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:sharedModels="clr-namespace:COBIeManager.Shared.Models"
    xmlns:viewModels="clr-namespace:COBIeManager.Features.ParameterFiller.ViewModels"
    Title="Map Parameters to Fill Modes"
    Width="550"
    Height="500"
    Background="Transparent"
    FontFamily="{DynamicResource MaterialDesignFont}"
    ResizeMode="CanResize"
    WindowStartupLocation="CenterOwner"
    WindowStyle="SingleBorderWindow">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/COBIeManager;component/Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <converters:FillModeToIndexConverter x:Key="FillModeToIndexConverter" />

            <!--  Parameter Row Style  -->
            <Style x:Key="ParameterRow" TargetType="Border">
                <Setter Property="Padding" Value="10,6" />
                <Setter Property="Margin" Value="0,0,0,1" />
                <Setter Property="BorderBrush" Value="#E0E0E0" />
                <Setter Property="BorderThickness" Value="0,0,0,1" />
                <Setter Property="Background" Value="White" />
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Border
            Background="White"
            BorderThickness="1"
            CornerRadius="6"
            materialDesign:ElevationAssist.Elevation="Dp4">
            <Grid Margin="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Header  -->
                    <Grid Grid.Row="0" Background="{StaticResource AppBackgroundBrush}">
                        <Grid Margin="16,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <materialDesign:PackIcon
                                Grid.Column="0"
                                Width="24"
                                Height="24"
                                Margin="0,0,12,0"
                                VerticalAlignment="Center"
                               
                                Kind="Tune" />

                            <StackPanel Grid.Column="1">
                                <TextBlock
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    
                                    Text="Map Parameters to Fill Modes" />
                                <TextBlock
                                    Margin="0,2,0,0"
                                    FontSize="11"
                                    
                                    Text="Assign which fill mode each parameter should use" />
                            </StackPanel>
                        </Grid>
                    </Grid>

                <!--  Bulk Actions Bar  -->
                <Border
                    Grid.Row="1"
                    Padding="12,8"
                    Background="#F5F5F5"
                    BorderBrush="#E0E0E0"
                    BorderThickness="0,0,0,1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock
                                VerticalAlignment="Center"
                                FontSize="11"
                                Foreground="#757575">
                                <Run Text="Unmapped:" />
                                <Run FontWeight="SemiBold" Text="{Binding UnmappedCount, Mode=OneWay}" />
                                <Run Text="•" />
                                <Run Text="Mapped:" />
                                <Run FontWeight="SemiBold" Text="{Binding MappedCount, Mode=OneWay}" />
                                <Run Text="•" />
                                <Run Text="Total:" />
                                <Run FontWeight="SemiBold" Text="{Binding TotalCount, Mode=OneWay}" />
                            </TextBlock>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <Button
                                Width="90"
                                Height="28"
                                Margin="0"
                                Padding="6,4"
                                Command="{Binding SetAllUnmappedToLevelCommand}"
                                FontSize="9"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="12"
                                        Height="12"
                                        Margin="0,0,2,0"
                                        VerticalAlignment="Center"
                                        Kind="Layers" />
                                    <TextBlock
                                        Margin="0"
                                        VerticalAlignment="Center"
                                        Text="Level" />
                                </StackPanel>
                            </Button>
                            <Button
                                Width="90"
                                Height="28"
                                Margin="3,0,0,0"
                                Padding="6,4"
                                Command="{Binding SetAllUnmappedToRoomNameCommand}"
                                FontSize="9"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="12"
                                        Height="12"
                                        Margin="0,0,2,0"
                                        VerticalAlignment="Center"
                                        Kind="Home" />
                                    <TextBlock
                                        Margin="0"
                                        VerticalAlignment="Center"
                                        Text="Name" />
                                </StackPanel>
                            </Button>
                            <Button
                                Width="90"
                                Height="28"
                                Margin="3,0,0,0"
                                Padding="6,4"
                                Command="{Binding SetAllUnmappedToRoomNumberCommand}"
                                FontSize="9"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="12"
                                        Height="12"
                                        Margin="0,0,2,0"
                                        VerticalAlignment="Center"
                                        Kind="Numeric" />
                                    <TextBlock
                                        Margin="0"
                                        VerticalAlignment="Center"
                                        Text="Number" />
                                </StackPanel>
                            </Button>
                            <Button
                                Width="90"
                                Height="28"
                                Margin="3,0,0,0"
                                Padding="6,4"
                                Command="{Binding SetAllUnmappedToGroupsCommand}"
                                FontSize="9"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="12"
                                        Height="12"
                                        Margin="0,0,2,0"
                                        VerticalAlignment="Center"
                                        Kind="Group" />
                                    <TextBlock
                                        Margin="0"
                                        VerticalAlignment="Center"
                                        Text="Groups" />
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!--  Parameter List  -->
                    <ScrollViewer
                        Grid.Row="2"
                        Padding="0"
                        VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding SelectedParameters}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Style="{StaticResource ParameterRow}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <!--  Parameter Name  -->
                                            <StackPanel Grid.Column="0">
                                                <TextBlock
                                                    FontSize="12"
                                                    FontWeight="SemiBold"
                                                    Text="{Binding DisplayName}" />
                                                <TextBlock
                                                    FontSize="10"
                                                    Foreground="#757575"
                                                    Text="{Binding Description}" />
                                            </StackPanel>

                                            <!--  Mode Selection  -->
                                            <ComboBox
                                                Grid.Column="1"
                                                Width="140"
                                                FontSize="11"
                                                SelectedIndex="{Binding ApplicableMode, Converter={StaticResource FillModeToIndexConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                Style="{StaticResource MaterialDesignOutlinedComboBox}">
                                                <ComboBoxItem Content="Level" />
                                                <ComboBoxItem Content="Room Name" />
                                                <ComboBoxItem Content="Room Number" />
                                                <ComboBoxItem Content="Groups" />
                                            </ComboBox>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                <!--  Footer  -->
                    <Border
                        Grid.Row="3"
                        Padding="16,10"
                        Background="#F5F5F5"
                        BorderBrush="#E0E0E0"
                        BorderThickness="0,1,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!--  Validation Message  -->
                            <Border
                                Grid.Column="0"
                                Padding="10,6"
                                Background="#FFF3E0"
                                BorderBrush="#FF9800"
                                BorderThickness="1"
                                CornerRadius="4"
                                Visibility="{Binding HasUnmappedParameters, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <materialDesign:PackIcon
                                        Grid.Column="0"
                                        Width="16"
                                        Height="16"
                                        Margin="0,0,8,0"
                                        VerticalAlignment="Center"
                                        Foreground="#E65100"
                                        Kind="Alert" />
                                    <TextBlock
                                        Grid.Column="1"
                                        VerticalAlignment="Center"
                                        FontSize="11"
                                        Foreground="#E65100"
                                        Text="All parameters must be mapped before continuing" />
                                </Grid>
                            </Border>

                            <!--  Action Buttons  -->
                            <StackPanel
                                Grid.Column="1"
                                Margin="8,0,0,0"
                                Orientation="Horizontal">
                                <Button
                                    Width="80"
                                    Height="32"
                                    Margin="0"
                                    Padding="12,6"
                                    Click="Cancel_Click"
                                    Content="Cancel"
                                    Style="{StaticResource MaterialDesignOutlinedButton}" />
                                <Button
                                    Width="80"
                                    Height="32"
                                    Margin="6,0,0,0"
                                    Padding="12,6"
                                    Click="Ok_Click"
                                    Content="Apply"
                                    IsEnabled="{Binding IsValid, Mode=OneWay}"
                                    Style="{StaticResource MaterialDesignRaisedButton}" />
                            </StackPanel>
                        </Grid>
                    </Border>
            </Grid>
        </Border>
    </Grid>

</Window>
